<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>BYBIT MASAKR â€“ PAPER DASHBOARD</title>

<style>
  body {
    margin: 0;
    font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
    background: #0e0e11;
    color: #eaeaea;
  }

  header {
    padding: 12px;
    background: #16161d;
    text-align: center;
    font-weight: bold;
    font-size: 16px;
    position: sticky;
    top: 0;
    z-index: 10;
  }

  .stats {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 10px;
    padding: 10px;
  }

  .stat {
    background: #1b1b25;
    padding: 10px;
    border-radius: 10px;
    text-align: center;
    font-size: 14px;
  }

  .stat span {
    display: block;
    font-size: 18px;
    font-weight: bold;
    margin-top: 5px;
  }

  .log-container {
    padding: 10px;
  }

  .log-title {
    margin-bottom: 6px;
    font-size: 14px;
    opacity: 0.8;
  }

  .log {
    background: #111118;
    border-radius: 10px;
    max-height: 60vh;
    overflow-y: auto;
    padding: 8px;
  }

  .trade {
    padding: 8px;
    border-bottom: 1px solid #222;
    font-size: 13px;
  }

  .trade:last-child {
    border-bottom: none;
  }

  .buy { color: #4caf50; }
  .sell { color: #ff5252; }

  .pnl-pos { color: #4caf50; font-weight: bold; }
  .pnl-neg { color: #ff5252; font-weight: bold; }

  footer {
    padding: 8px;
    text-align: center;
    font-size: 11px;
    opacity: 0.5;
  }
</style>
</head>

<body>

<header>
ðŸ¤– BYBIT PORTFOLIO BOT â€“ MASAKR (PAPER)
</header>

<div class="stats">
  <div class="stat">Obchody<span id="count">0</span></div>
  <div class="stat">CelkovÃ½ PnL<span id="total">0</span></div>
  <div class="stat">Winrate<span id="winrate">0%</span></div>
  <div class="stat">ZiskovÃ©<span id="wins">0</span></div>
</div>

<div class="log-container">
  <div class="log-title">ðŸ“¡ Live feed</div>
  <div id="log" class="log"></div>
</div>

<footer>
auto refresh kaÅ¾dÃ© 2s Â· paper trading
</footer>

<script>
const logEl = document.getElementById("log");
const countEl = document.getElementById("count");
const totalEl = document.getElementById("total");
const winrateEl = document.getElementById("winrate");
const winsEl = document.getElementById("wins");

async function loadTrades() {
  try {
    const res = await fetch("./logs/trades.json?_=" + Date.now());
    const trades = await res.json();

    logEl.innerHTML = "";

    let totalPnL = 0;
    let wins = 0;

    trades.slice().reverse().forEach(t => {
      totalPnL += t.pnl;
      if (t.pnl > 0) wins++;

      const div = document.createElement("div");
      div.className = "trade";
      div.innerHTML = `
        <div>
          <b>${t.symbol}</b> Â· ${t.tf}m Â· ${t.strategy}
          <span class="${t.side === "BUY" ? "buy" : "sell"}">
            ${t.side}
          </span>
        </div>
        <div>
          entry: ${t.entry.toFixed(2)} â†’ exit: ${t.exit.toFixed(2)}
          |
          <span class="${t.pnl >= 0 ? "pnl-pos" : "pnl-neg"}">
            ${t.pnl.toFixed(3)}
          </span>
        </div>
      `;
      logEl.appendChild(div);
    });

    countEl.textContent = trades.length;
    totalEl.textContent = totalPnL.toFixed(3);
    winsEl.textContent = wins;
    winrateEl.textContent = trades.length
      ? ((wins / trades.length) * 100).toFixed(1) + "%"
      : "0%";

    // auto scroll nahoru (nejnovÄ›jÅ¡Ã­)
    logEl.scrollTop = 0;

  } catch (e) {
    console.error("Dashboard load error", e);
  }
}

loadTrades();
setInterval(loadTrades, 2000);
</script>

</body>
</html>